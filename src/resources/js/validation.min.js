tribe.validation={},function(t,i,e){"use strict";var a=i(document);t.selectors={item:".tribe-validation",fields:"input, select, textarea",submit:".tribe-validation-submit",submitButtons:'input[type="submit"], button[type="submit"]',error:".tribe-validation-error",valid:".tribe-validation-valid",notice:".tribe-notice-validation",noticeAfter:".wp-header-end",noticeDismiss:".notice-dismiss"},t.conditions={isRequired:function(t){return""!=t},isGreaterThan:function(i,e,a){var r=t.parseConditon("isGreaterThan",i,e,a);return r.constraint<r.value},isGreaterOrEqualTo:function(i,e,a){var r=t.parseConditon("isGreaterOrEqualTo",i,e,a);return r.constraint<=r.value},isLessThan:function(i,e,a){var r=t.parseConditon("isLessThan",i,e,a);return r.constraint>r.value},isLessOrEqualTo:function(i,e,a){var r=t.parseConditon("isLessOrEqualTo",i,e,a);return r.constraint>=r.value},isEqualTo:function(i,e,a){var r=t.parseConditon("isEqualTo",i,e,a);return r.constraint==r.value},isNotEqualTo:function(i,e,a){var r=t.parseConditon("isNotEqualTo",i,e,a);return r.constraint!=r.value}},t.parseType={datepicker:function(t,i,a){var r=["yyyy-mm-dd","m/d/yyyy","mm/dd/yyyy","d/m/yyyy","dd/mm/yyyy","m-d-yyyy","mm-dd-yyyy","d-m-yyyy","dd-mm-yyyy"],n=0;i.length&&i.attr("data-datepicker_format")?n=i.attr("data-datepicker_format"):e.isString(r[i])?n=r[i]:i.parents("[data-datepicker_format]").length&&(n=i.parents("[data-datepicker_format]").eq(0).data("datepicker_format"));var s=r[n].toUpperCase();return t=moment(t,s).format("X")}},t.constraints={isRequired:function(t){var i=null;return i=t.data("required")||i,i=t.data("validationRequired")||i,i=t.data("validationIsRequired")||i,i=t.is("[required]")||i,i=t.is("[data-required]")||i,i=t.is("[data-validation-required]")||i,i=t.is("[data-validation-is-required]")||i},isGreaterThan:function(t){var i=null;return t.is("[data-validation-is-greater-than]")&&(i=t.data("validationIsGreaterThan")),i},isGreaterOrEqualTo:function(t){var i=null;return t.is("[data-validation-is-greater-or-equal-to]")&&(i=t.data("validationIsGreaterOrEqualTo")),i},isLessThan:function(t){var i=null;return t.is("[data-validation-is-less-than]")&&(i=t.data("validationIsLessThan")),i},isLessOrEqualTo:function(t){var i=null;return t.is("[data-validation-is-less-or-equal-to]")&&(i=t.data("validationIsLessOrEqualTo")),i},isEqualTo:function(t){var i=null;return t.is("[data-validation-is-equal-to]")&&(i=t.data("validationIsEqualTo")),i},isNotEqualTo:function(t){var i=null;return t.is("[data-validation-is-not-equal-to]")&&(i=t.data("validationIsNotEqualTo")),i}},t.parseConditon=function(a,r,n,s){var o=s.data("validationType"),l=null,d={value:r,constraint:n};if(!e.isNumber(n)){if(l=i(n),!l.length)return console.warning("Tribe Validation:","Invalid selector for",s,selector),d;n=l.val()}return o&&e.isFunction(t.parseType[o])&&(d.constraint=t.parseType[o](n,l,s),d.value=t.parseType[o](r,l,s)),d},t.fn=function(){return this.each(t.setup)},t.setup=function(e,r){var n=i(r);n.addClass(t.selectors.item.className()),n.find(t.selectors.submitButtons).addClass(t.selectors.submit.className()),n.on("submit.tribe",t.onSubmit),n.on("validation.tribe",t.onValidation),n.on("displayErrors.tribe",t.onDisplayErrors),a.on("click.tribe",t.selectors.submit,t.onClickSubmitButtons),a.on("click.tribe",t.selectors.noticeDismiss,t.onClickDismissNotice)},t.validate=function(e,a){var r=i(a),n=t.isValid(r);n||(r.addClass(t.selectors.error.className()),r.one("change",t.onChangeFieldRemoveError))},t.isValid=function(i){var a=t.getConstraints(i);if(!e.isObject(a))return a;var r=e.every(a);return r},t.hasErrors=function(i){var e=i.find(t.selectors.error).not(":disabled");return 0!==e.length},t.getConstraints=function(i){var a=i.is(":disabled"),r=!0;if(a)return r;var n=t.getConstraintsValue(i),s=i.val();return e.isEmpty(n)?r:n=e.mapObject(n,function(e,a){return t.conditions[a](s,e,i)})},t.getConstraintsValue=function(i){var a=i.is(":disabled"),r={};return a?r:(r=t.constraints,r=e.mapObject(r,function(t){return t(i)}),r=e.pick(r,function(t){return null!==t}))},t.getConstraintsFields=function(a){var r=t.getConstraintsValue(a);return r=e.mapObject(r,function(t){var a=null;return e.isNumber(t)||e.isBoolean(t)||(a=i(t)),a}),r=e.pick(r,function(t){return t instanceof jQuery}),r=e.values(r),r.unshift(a),r=i(r).map(function(){return this.get()})},t.onValidation=function(e){var a=i(this),r=a.find(t.selectors.fields);r.each(t.validate);var n=a.find(t.selectors.error).not(":disabled");return 0!==n.length?void a.trigger("displayErrors.tribe"):void a.addClass(t.selectors.valid.className())},t.onDisplayErrors=function(r){var n=i(this),s=n.find(t.selectors.error).not(":disabled"),o=i("<ul>"),l=i("<span>").addClass(t.selectors.noticeDismiss.className()),d=a.find(t.selectors.notice),u=i("<div>").addClass("notice notice-error is-dismissible tribe-notice").addClass(t.selectors.notice.className()).append(l);if(s.each(function(a,r){var n=i(r),s=n.data("validationError");if(e.isObject(s)){var l={},d=t.getConstraints(n,!1);e.each(s,function(t,i){l[tribe.utils.camelCase(i)]=t}),e.each(d,function(i,e){i||t.addErrorLine(l[e],n,o)})}else t.addErrorLine(s,n,o)}),u.append(o),0===d.length){var c=a.find(t.selectors.noticeAfter);c.after(u)}else d.replaceWith(u)},t.addErrorLine=function(t,e,a){var r=i("<li>").text(t);r.data("validationField",e),e.data("validationNoticeItem",e),a.append(r)},t.onSubmit=function(e){var a=i(this);a.trigger("validation.tribe");var r=a.is(t.selectors.valid);if(!r)return e.preventDefault(),!1},t.onClickSubmitButtons=function(e){var a=i(this),r=a.parents(t.selectors.item);if(0!==r.length){r.trigger("validation.tribe");var n=r.find(t.selectors.fields);n.off("invalid.tribe"),n.one("invalid.tribe",t.onInvalidField)}},t.onInvalidField=function(e){var a=i(this),r=a.parents(t.selectors.item);return a.addClass(t.selectors.error.className()),r.trigger("displayErrors.tribe"),a.one("change",t.onChangeFieldRemoveError),e.preventDefault(),!1},t.onChangeFieldRemoveError=function(e){var a=i(this),r=t.getConstraintsFields(a);0!==r.filter(t.selectors.error).length&&r.removeClass(t.selectors.error.className())},t.onClickDismissNotice=function(e){var a=i(this),r=a.parents(t.selectors.notice);r.remove()},t.onReady=function(e){i(t.selectors.item).validation()},i.fn.validation=t.fn,a.ready(t.onReady)}(tribe.validation,jQuery,_);